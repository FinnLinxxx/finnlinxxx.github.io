:root{
  --mf-air:#87CEEB;      /* Luft */
  --mf-mat:#b99b71;      /* Material */
  --mf-line:#1c2a38;     /* Interface */
  --mf-accent:#2f81f7;
  --mf-muted:#6b7c8f;

  --photon-reflect:#ff5d2a;  /* rote Photonen (Reflexion) */
  --photon-sss:#8a2be2;      /* lila Photonen (SSS) */
  --mf-emitter:#00bcd4;      /* Emitter */

  --ovl-plane:#6b5cff;   /* Orthogonale (lila) */
  --ovl-in:#00bcd4;      /* Einfallslinie (cyan) */
  --ovl-arc:#202939;     /* Winkelbogen */
  --ovl-fit:#2ecc71;     /* Fit-Linie (grün) + Punkte */

  --detector:#f0b93a;    /* Detektor-Linie */
  --total:#111;          /* Summenkurve im Histogramm */

  --grid:#e4e7eb;
  --panel-bg:#fff;
  --panel-br:#e4e7eb;
  --panel-shadow:0 10px 24px rgba(0,0,0,.10);
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  display:grid;
  grid-template-columns: minmax(420px, 1fr) minmax(480px, 46vw);
  grid-template-rows: 100vh;
  gap:0;
  font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  color:#2b3645; background:#fff;
}

/* Linke Seite: Canvas + Controls */
#left{
  display:flex; flex-direction:column; align-items:center; justify-content:flex-start;
  padding:14px 16px; gap:12px;
}

/* ⬇️ Simulationsbox jetzt direkt mit Mausgröße änderbar */
.mf-box{
  width:160mm;                /* initiale Größe */
  height:120mm;
  position:relative;
  resize: both;               /* native Resize-Ecke */
  overflow:hidden;            /* für den Resize-Griff nötig */
  min-width:320px;
  min-height:220px;
  max-width:95vw;
  max-height:95vh;
}

.mf-canvas{
  width:100%; height:100%;
  display:block;
  border-radius:10px;
  box-shadow:0 12px 38px rgba(0,0,0,.12);
  background:transparent;
}

/* Controls (links) */
.mf-controls{ display:grid; gap:8px; width:160mm; max-width:90vw; }
.mf-row{ display:grid; grid-template-columns: 180px minmax(0,1fr) 140px; align-items:center; gap:10px; }
.mf-row label{ color:var(--mf-muted); font-weight:700; white-space:nowrap }
.mf-val{ justify-self:end; color:var(--mf-accent); font-weight:800; white-space:nowrap; overflow:hidden; text-overflow:ellipsis }
.mf-row input[type=range]{ -webkit-appearance:none; width:100%; height:6px; border-radius:999px; background:#d0d7de; outline:none; cursor:pointer }
.mf-row input[type=range]::-webkit-slider-thumb{ -webkit-appearance:none; width:16px; height:16px; border-radius:50%; background:var(--mf-accent); box-shadow:0 0 0 3px rgba(47,129,247,.18) }
.mf-row input[type=checkbox]{ width:18px; height:18px; }
.btnRow{ display:flex; gap:8px; align-items:center; }
button{ appearance:none; border:1px solid #d5dbe0; background:#fff; border-radius:8px; padding:8px 12px; font-weight:600; cursor:pointer; box-shadow:0 1px 2px rgba(0,0,0,.04) }
button:hover{ background:#f2f5f8 }
.primary{ background:#0d6efd; color:#fff; border-color:#0d6efd }
.primary:hover{ background:#0b5ed7 }

/* Rechte Seite: Histogramm-Panel */
#right{
  display:flex; flex-direction:column; background:#eef2f6; padding:16px; gap:14px; overflow:hidden;
  border-left:1px solid var(--panel-br);
}
.panel{
  background:var(--panel-bg);
  border:1px solid var(--panel-br);
  border-radius:12px;
  box-shadow:var(--panel-shadow);
  padding:14px;
}
#histCanvas{
  width:100%; height:360px;
  border-radius:10px;
  border:1px solid var(--panel-br);
  background:#fff; display:block;
}
.legendRow{ display:flex; flex-wrap:wrap; gap:12px; align-items:center; }
.chip{ padding:2px 6px; border-radius:999px; background:#f2f5f8; border:1px solid var(--panel-br); font-weight:700 }
.swatch{ display:inline-block; width:12px; height:12px; border-radius:3px; margin-right:6px; vertical-align:middle }
.sw-red{ background: var(--photon-reflect) }
.sw-sss{ background: var(--photon-sss) }
.sw-total{ background: var(--total) }

.rightControls{ display:grid; gap:10px }
.rightRow{ display:grid; grid-template-columns: 140px 1fr 140px; align-items:center; gap:10px }
.rightRow .val{ text-align:right; font-weight:800; color:#0d6efd }
.rightRow input[type=checkbox]{ width:18px; height:18px; }
.rightRow select{ padding:6px 10px; border-radius:8px; border:1px solid #d5dbe0; background:#fff; font-weight:600 }

/* Kleine Plot-Typografie */
.plot-axis-label{
  font: 12px/1.2 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  fill:#445;
}

